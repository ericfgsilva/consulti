define("parsley/form",["parsley/abstract","parsley/utils"],function(ParsleyAbstract,ParsleyUtils){var ParsleyForm=function(element,OptionsFactory){if(this.__class__="ParsleyForm",this.__id__=ParsleyUtils.hash(4),"OptionsFactory"!==ParsleyUtils.get(OptionsFactory,"__class__"))throw new Error("You must give an OptionsFactory instance");this.OptionsFactory=OptionsFactory,this.$element=$(element),this.validationResult=null,this.options=this.OptionsFactory.get(this)};return ParsleyForm.prototype={onSubmitValidate:function(event){return this.validate(void 0,void 0,event),!1===this.validationResult&&event instanceof $.Event&&(event.stopImmediatePropagation(),event.preventDefault()),this},validate:function(group,force,event){this.submitEvent=event,this.validationResult=!0;var fieldValidationResult=[];this._refreshFields(),$.emit("parsley:form:validate",this);for(var i=0;i<this.fields.length;i++)group&&group!==this.fields[i].options.group||(fieldValidationResult=this.fields[i].validate(force),!0!==fieldValidationResult&&fieldValidationResult.length>0&&this.validationResult&&(this.validationResult=!1));return $.emit("parsley:form:validated",this),this.validationResult},isValid:function(group,force){this._refreshFields();for(var i=0;i<this.fields.length;i++)if((!group||group===this.fields[i].options.group)&&!1===this.fields[i].isValid(force))return!1;return!0},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var self=this;return this.fields=[],this.fieldsMappedById={},this.$element.find(this.options.inputs).each(function(){var fieldInstance=new window.Parsley(this,{},self);"ParsleyField"!==fieldInstance.__class__&&"ParsleyFieldMultiple"!==fieldInstance.__class__||fieldInstance.$element.is(fieldInstance.options.excluded)||"undefined"==typeof self.fieldsMappedById[fieldInstance.__class__+"-"+fieldInstance.__id__]&&(self.fieldsMappedById[fieldInstance.__class__+"-"+fieldInstance.__id__]=fieldInstance,self.fields.push(fieldInstance))}),this}},ParsleyForm});